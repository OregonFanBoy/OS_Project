package programs;

import java.io.IOException;
import java.io.PrintWriter;
import java.util.Random;

import header.DataBase;
import header.Program;

public class Writer extends Thread {

	private DataBase[] db;
	private int writeNum, record, wr;
	private double value;
	private String result;
	private PrintWriter out;
	
	public Writer(int num, DataBase[] db, PrintWriter out, int wr){
		this.writeNum = num;
		this.db = db;
		this.out = out;
		this.wr = wr;
	}
	
	public void run(){
		Random rand = new Random();
		
		try{
			for(int j = 0; j < wr; j++){
				record = rand.nextInt(db.length);
				for(int i =0; i < db.length; i ++){
				out.println("Thread Writer " + writeNum + " locked recored " + record + " for write");
				}
				for(int i = 0; i < db.length; i ++){
				value = Math.random()*1;
				db[record].aquireWrite();
				result = Program.system(("write " + record + " " + value).toString());
				}
				for(int i = 0; i < db.length; i++){
				out.println("Thread Writer " + writeNum + " wrote " + record + " value = " + result);
				db[record].releaseWrite();
				out.println("Thread Writer " + writeNum + " released record " + record + " for write");
				}
				Program.schedule();
			
			}
		}
		catch(InterruptedException | IOException e){}
	}
}
